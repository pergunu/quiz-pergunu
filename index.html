<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Pergunu - Sistem Ujian Lengkap</title>
    <!-- Favicon -->
    <link rel="icon" href="https://raw.githubusercontent.com/pergunu/quiz-pergunu/main/assets/images/logo.png" type="image/png">
    
    <!-- Font & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Library untuk screenshot -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <!-- Library untuk efek partikel -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1e40af;
            --secondary: #dc2626;
            --secondary-light: #ef4444;
            --secondary-dark: #b91c1c;
            --success: #16a34a;
            --success-light: #22c55e;
            --success-dark: #15803d;
            --warning: #d97706;
            --danger: #b91c1c;
            --light: #f8fafc;
            --lighter: #f1f5f9;
            --dark: #1e293b;
            --darker: #0f172a;
            --gray: #64748b;
            --light-gray: #e2e8f0;
            --radius: 12px;
            --radius-sm: 8px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 25px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --gradient-primary: linear-gradient(135deg, var(--primary), var(--primary-dark));
            --gradient-success: linear-gradient(135deg, var(--success), var(--success-dark));
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: var(--lighter);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            padding-bottom: 120px;
            background-image: radial-gradient(circle at 10% 20%, rgba(37, 99, 235, 0.05) 0%, rgba(37, 99, 235, 0.05) 90%);
            overflow-x: hidden;
        }

        /* Opening Animation - Premium Enhanced */
        .opening-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            animation: fadeOut 1.5s ease-in-out 12s forwards;
            overflow: hidden;
        }

        .opening-screen::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulseOpening 10s infinite linear;
            z-index: -1;
        }

        .opening-logo {
            width: 150px;
            height: 150px;
            margin-bottom: 2rem;
            animation: pulse 2s infinite, float 3s ease-in-out infinite;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2), 0 0 0 15px rgba(255,255,255,0.1);
            object-fit: contain;
            background: white;
            padding: 10px;
            transform-style: preserve-3d;
            perspective: 1000px;
            z-index: 1;
        }

        .opening-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            font-family: 'Playfair Display', serif;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.8s ease-out 0.5s forwards;
            opacity: 0;
            background: linear-gradient(to right, #fff, #e0e0e0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }

        .opening-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: white;
            border-radius: 3px;
            opacity: 0.7;
        }

        .opening-subtitle {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto 2rem;
            opacity: 0.9;
            animation: slideUp 0.8s ease-out 1s forwards;
            opacity: 0;
            text-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-weight: 300;
            letter-spacing: 0.5px;
        }

        .opening-message {
            font-size: 1rem;
            max-width: 500px;
            margin: 2rem auto 0;
            font-style: italic;
            opacity: 0.8;
            animation: fadeIn 1s ease-out 2s forwards;
            opacity: 0;
            padding: 0.75rem 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .opening-footer {
            position: absolute;
            bottom: 2rem;
            font-size: 0.85rem;
            opacity: 0.7;
            animation: fadeIn 1s ease-out 3s forwards;
            opacity: 0;
        }

        /* Terms and Conditions Modal */
        .terms-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 9998;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .terms-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .terms-container {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            padding: 2.5rem;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: fadeInUp 0.5s ease-out;
            transform: translateY(20px);
            border: 1px solid rgba(37, 99, 235, 0.1);
        }

        .terms-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: var(--gradient-primary);
        }

        .terms-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .terms-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 1rem;
            font-family: 'Playfair Display', serif;
            font-weight: 600;
        }

        .terms-content {
            margin-bottom: 2rem;
            line-height: 1.7;
        }

        .terms-content h3 {
            color: var(--primary);
            margin: 1.5rem 0 0.5rem;
            font-size: 1.2rem;
        }

        .terms-content p {
            margin-bottom: 1rem;
        }

        .terms-content ul {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .terms-checkbox {
            display: flex;
            align-items: center;
            margin: 1.5rem 0;
        }

        .terms-checkbox input {
            margin-right: 1rem;
            width: 20px;
            height: 20px;
        }

        .terms-checkbox label {
            font-weight: 500;
        }

        .terms-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        /* Particle Background */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        /* Floating Stars Animation */
        .floating-stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.8);
            animation: floatStar linear infinite;
            opacity: 0;
        }

        @keyframes floatStar {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Main Content */
        .main-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            min-height: calc(100vh - 180px);
            animation: fadeIn 1s ease-out;
            position: relative;
            z-index: 1;
        }

        /* Participant Form - Premium Redesign */
        .participant-form {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            padding: 3rem;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(37, 99, 235, 0.1);
            animation: fadeInUp 0.8s ease-out;
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            position: relative;
            backdrop-filter: blur(5px);
        }

        .participant-form::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 10px;
            background: var(--gradient-primary);
        }

        .participant-form::after {
            content: '';
            position: absolute;
            bottom: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, var(--primary-light) 0%, transparent 70%);
            opacity: 0.1;
            z-index: 0;
        }

        /* ... (keep all other existing styles, just enhance them with more animations and effects) ... */

        /* Enhanced Floating Action Buttons */
        .fab-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            z-index: 100;
        }

        .fab {
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            background: white;
            color: var(--dark);
            border: none;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .fab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: translateX(-100%);
            transition: 0.6s;
        }

        .fab:hover::before {
            transform: translateX(100%);
        }

        .fab-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .fab-success {
            background: linear-gradient(to right, #25d366, #128c7e);
            color: white;
        }

        .fab-danger {
            background: linear-gradient(to right, #ef4444, #b91c1c);
            color: white;
        }

        .fab-info {
            background: linear-gradient(to right, #0ea5e9, #0369a1);
            color: white;
        }

        .fab:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .fab-tooltip {
            position: absolute;
            right: 4.5rem;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-lg);
            font-size: 0.85rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: var(--transition);
        }

        .fab:hover .fab-tooltip {
            opacity: 1;
            right: 5rem;
        }

        /* Prayer Time Notification */
        .prayer-notification {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient-primary);
            color: white;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: slideUp 0.5s ease-out;
            display: none;
        }

        .prayer-notification i {
            font-size: 1.5rem;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main-container {
                padding: 1rem;
            }
            
            .participant-form {
                padding: 2rem 1.5rem;
            }
            
            .form-logo {
                width: 80px;
                height: 80px;
            }
            
            .form-title {
                font-size: 1.75rem;
            }
            
            .category-tabs {
                flex-wrap: wrap;
            }
            
            .category-tab {
                flex: 1 0 45%;
            }
            
            .quiz-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .quiz-info {
                width: 100%;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .fab-container {
                bottom: 1rem;
                right: 1rem;
            }

            .fab {
                width: 3rem;
                height: 3rem;
                font-size: 1.1rem;
            }

            .fab-tooltip {
                display: none;
            }

            .terms-container {
                padding: 1.5rem;
                max-width: 90%;
            }
        }

        @media (max-width: 480px) {
            .participant-form {
                padding: 1.5rem 1rem;
            }
            
            .form-title {
                font-size: 1.5rem;
            }
            
            .subcategory-options {
                grid-template-columns: 1fr;
            }
            
            .share-buttons {
                flex-direction: column;
            }
            
            .share-btn {
                justify-content: center;
            }

            .opening-title {
                font-size: 2rem;
            }

            .opening-subtitle {
                font-size: 1rem;
            }

            .terms-actions {
                flex-direction: column;
            }
        }

        /* Animations */
        @keyframes pulseOpening {
            0% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(0.8); opacity: 0.5; }
        }

        @keyframes fadeOut {
            to { opacity: 0; visibility: hidden; }
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255,255,255,0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(255,255,255,0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255,255,255,0); }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        @keyframes gradientBackground {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatStar {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Opening Animation - Enhanced -->
    <div class="opening-screen">
        <img src="https://raw.githubusercontent.com/pergunu/quiz-pergunu/main/assets/images/logo.png" alt="Pergunu Logo" class="opening-logo">
        <h1 class="opening-title">Selamat Datang di Quiz Pergunu</h1>
        <p class="opening-subtitle">Uji pengetahuan Anda dan raih prestasi terbaik bersama PERGUNU SITUBONDO</p>
        <p class="opening-message">"Ilmu tanpa amal seperti pohon tanpa buah"</p>
        <p class="opening-footer">Design Creat By Cendhanu</p>
        <audio id="openingAudio" autoplay>
            <source src="https://voca.ro/1a8eWbggFzfB" type="audio/mpeg">
        </audio>
    </div>

    <!-- Terms and Conditions Modal -->
    <div class="terms-modal" id="termsModal">
        <div class="terms-container">
            <div class="terms-header">
                <h2 class="terms-title">Ketentuan Penggunaan Quiz Pergunu</h2>
            </div>
            <div class="terms-content">
                <h3>1. Persetujuan Umum</h3>
                <p>Dengan mengakses dan menggunakan aplikasi Quiz Pergunu, Anda menyetujui untuk terikat oleh ketentuan dan syarat penggunaan ini. Jika Anda tidak setuju dengan syarat-syarat ini, harap tidak menggunakan aplikasi ini.</p>
                
                <h3>2. Penggunaan Aplikasi</h3>
                <p>Aplikasi Quiz Pergunu disediakan untuk tujuan pendidikan dan pengujian pengetahuan. Anda setuju untuk menggunakan aplikasi ini hanya untuk tujuan yang sah dan sesuai dengan ketentuan yang berlaku.</p>
                
                <h3>3. Kebijakan Privasi</h3>
                <p>Data pribadi yang dikumpulkan melalui formulir pendaftaran akan digunakan hanya untuk keperluan administrasi Quiz Pergunu. Kami tidak akan membagikan informasi pribadi Anda kepada pihak ketiga tanpa persetujuan Anda, kecuali jika diwajibkan oleh hukum.</p>
                
                <h3>4. Hak Kekayaan Intelektual</h3>
                <p>Seluruh konten, termasuk tetapi tidak terbatas pada teks, grafis, logo, dan kode yang terdapat dalam aplikasi ini adalah milik PERGUNU SITUBONDO atau pemberi lisensi dan dilindungi oleh undang-undang hak cipta.</p>
                
                <h3>5. Perilaku Pengguna</h3>
                <p>Anda setuju untuk tidak:</p>
                <ul>
                    <li>Menggunakan aplikasi untuk tujuan yang melanggar hukum</li>
                    <li>Mencoba mengganggu atau merusak sistem keamanan aplikasi</li>
                    <li>Melakukan tindakan yang dapat mengganggu pengguna lain</li>
                    <li>Menggunakan bot atau metode otomatis untuk mengakses aplikasi</li>
                </ul>
                
                <h3>6. Perubahan Ketentuan</h3>
                <p>PERGUNU SITUBONDO berhak mengubah ketentuan ini kapan saja tanpa pemberitahuan sebelumnya. Perubahan akan berlaku segera setelah diposting di aplikasi.</p>
                
                <h3>7. Pembatasan Tanggung Jawab</h3>
                <p>PERGUNU SITUBONDO tidak bertanggung jawab atas kerugian atau kerusakan yang timbul dari penggunaan aplikasi ini, termasuk tetapi tidak terbatas pada kerugian langsung, tidak langsung, insidental, atau konsekuensial.</p>
                
                <div class="terms-checkbox">
                    <input type="checkbox" id="agreeTerms" required>
                    <label for="agreeTerms">Saya telah membaca dan menyetujui semua ketentuan penggunaan Quiz Pergunu</label>
                </div>
                
                <div class="terms-actions">
                    <button class="btn btn-primary" id="acceptTerms">
                        <i class="fas fa-check-circle"></i> Saya Setuju
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Particle Background -->
    <div id="particles-js"></div>
    
    <!-- Floating Stars -->
    <div class="floating-stars" id="floatingStars"></div>
    
    <!-- Main Content -->
    <main class="main-container">
        <!-- Participant Form with integrated header -->
        <form id="participantForm" class="participant-form">
            <div class="form-header">
                <img src="https://raw.githubusercontent.com/pergunu/quiz-pergunu/main/assets/images/logo.png" alt="Pergunu Logo" class="form-logo">
                <h2 class="form-title">Quiz Pergunu</h2>
                <p class="form-subtitle">Silakan isi data diri Anda untuk memulai ujian pengetahuan</p>
            </div>
            
            <div class="form-group">
                <label for="name" class="form-label">Nama Lengkap</label>
                <input type="text" id="name" class="form-control" required placeholder="Masukkan nama lengkap Anda">
            </div>
            
            <div class="form-group">
                <label for="phone" class="form-label">Nomor HP/WhatsApp</label>
                <input type="tel" id="phone" class="form-control" required placeholder="Masukkan nomor yang bisa dihubungi">
            </div>
            
            <div class="form-group">
                <label for="email" class="form-label">Email</label>
                <input type="email" id="email" class="form-control" placeholder="Masukkan email Anda (opsional)">
            </div>
            
            <div class="form-group">
                <label class="form-label">Kategori Quiz</label>
                <div class="category-tabs">
                    <div class="category-tab active" data-category="pelajar">Pelajar</div>
                    <div class="category-tab" data-category="umum">Umum</div>
                </div>
                
                <!-- Subkategori untuk Pelajar -->
                <div class="subcategory-container" id="pelajarSubcategories">
                    <div class="subcategory-title">
                        <i class="fas fa-book"></i> Pilih Mata Pelajaran:
                    </div>
                    <div class="subcategory-options">
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="ipa" checked>
                            <span class="subcategory-label">IPA</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="ips">
                            <span class="subcategory-label">IPS</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="matematika">
                            <span class="subcategory-label">Matematika</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="agama">
                            <span class="subcategory-label">Agama</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="ppkn">
                            <span class="subcategory-label">PPKN</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="sejarah">
                            <span class="subcategory-label">Sejarah</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="bahasa_indonesia">
                            <span class="subcategory-label">Bahasa Indonesia</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="bahasa_inggris">
                            <span class="subcategory-label">Bahasa Inggris</span>
                        </label>
                    </div>
                </div>
                
                <!-- Subkategori untuk Umum -->
                <div class="subcategory-container" id="umumSubcategories" style="display: none;">
                    <div class="subcategory-title">
                        <i class="fas fa-star"></i> Pilih Jenis Ujian:
                    </div>
                    <div class="subcategory-options">
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="logika">
                            <span class="subcategory-label">Ujian Logika</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="sambung_lagu">
                            <span class="subcategory-label">Sambung Lagu</span>
                        </label>
                        <label class="subcategory-option">
                            <input type="radio" name="subcategory" class="subcategory-radio" value="peribahasa">
                            <span class="subcategory-label">Tebak Peribahasa</span>
                        </label>
                    </div>
                </div>
                
                <!-- Field Profesi (hanya untuk umum) -->
                <div class="form-group profesi-field" id="profesiField">
                    <label for="profesi" class="form-label">Profesi</label>
                    <input type="text" id="profesi" class="form-control" placeholder="Masukkan profesi Anda">
                </div>
            </div>
            
            <div class="form-group">
                <label for="level" class="form-label">Tingkat Kesulitan</label>
                <select id="level" class="form-control" required>
                    <option value="mudah">Mudah</option>
                    <option value="sedang">Sedang</option>
                    <option value="sulit">Sulit</option>
                </select>
            </div>
            
            <button type="submit" class="btn btn-primary" id="startQuiz">
                <i class="fas fa-play"></i> Mulai Quiz
            </button>
        </form>
        
        <!-- Quiz Container -->
        <div id="quizContainer" class="quiz-container">
            <div class="quiz-header">
                <h1 class="quiz-title"><i class="fas fa-question-circle"></i> Quiz Pergunu</h1>
                <div class="quiz-info">
                    <div class="quiz-info-item" id="quizCategory">
                        <i class="fas fa-tag"></i> Kategori: <span id="categoryDisplay">Pelajar</span>
                    </div>
                    <div class="quiz-info-item" id="quizSubcategory">
                        <i class="fas fa-book"></i> Subkategori: <span id="subcategoryDisplay">IPA</span>
                    </div>
                    <div class="quiz-info-item" id="quizLevel">
                        <i class="fas fa-signal"></i> Level: <span id="levelDisplay">Mudah</span>
                    </div>
                    <div class="quiz-info-item" id="quizTimer">
                        <i class="fas fa-clock"></i> <span id="timeDisplay">10:00</span>
                    </div>
                </div>
            </div>
            
            <div class="question-container">
                <span class="question-number" id="questionNumber">Pertanyaan 1 dari 10</span>
                <p class="question-text" id="questionText">Memuat pertanyaan...</p>
            </div>
            
            <div class="options-container" id="optionsContainer">
                <!-- Options will be loaded here -->
            </div>
            
            <div class="explanation" id="explanation">
                <div class="explanation-title">
                    <i class="fas fa-lightbulb"></i> Penjelasan Jawaban:
                </div>
                <p class="explanation-text" id="explanationText">Memuat penjelasan...</p>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn btn-secondary" id="resetBtn">
                    <i class="fas fa-redo"></i> Reset Quiz
                </button>
                <button class="btn btn-primary" id="nextBtn">
                    <i class="fas fa-arrow-right"></i> Selanjutnya
                </button>
            </div>
        </div>
        
        <!-- Results Container -->
        <div id="resultsContainer" class="results-container">
            <h2 class="results-title">Hasil Quiz</h2>
            <div class="score" id="scoreDisplay">0%</div>
            <p class="results-message" id="resultsMessage">Memuat hasil...</p>
            
            <div class="thank-you-message">
                <p>Terima kasih telah mengikuti Quiz Pergunu. Hasil yang Anda capai merupakan cerminan dari usaha dan pengetahuan Anda saat ini.</p>
                <p>Jangan berhenti belajar dan terus tingkatkan kemampuan Anda. Setiap langkah kecil dalam belajar akan membawa Anda menuju kesuksesan yang lebih besar.</p>
                <p>Semangat belajar dan sampai jumpa di quiz berikutnya!</p>
            </div>
            
            <div class="results-details">
                <h3><i class="fas fa-chart-bar"></i> Statistik Hasil</h3>
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="totalQuestions">0</div>
                        <div class="stat-label">Total Pertanyaan</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Jawaban Benar</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="wrongAnswers">0</div>
                        <div class="stat-label">Jawaban Salah</div>
                    </div>
                </div>
                
                <h3><i class="fas fa-clock"></i> Waktu Penyelesaian</h3>
                <p id="completionTime">-</p>
            </div>
            
            <div class="share-buttons">
                <a href="#" class="share-btn facebook" id="shareFacebook">
                    <i class="fab fa-facebook-f"></i> Share ke Facebook
                </a>
                <a href="#" class="share-btn twitter" id="shareTwitter">
                    <i class="fab fa-twitter"></i> Share ke Twitter
                </a>
                <a href="#" class="share-btn whatsapp" id="shareWhatsapp">
                    <i class="fab fa-whatsapp"></i> Share ke WhatsApp
                </a>
                <button class="share-btn print" id="printBtn">
                    <i class="fas fa-print"></i> Cetak Hasil
                </button>
                <button class="share-btn screenshot" id="screenshotBtn">
                    <i class="fas fa-camera"></i> Ambil Screenshot
                </button>
            </div>
            
            <button class="btn btn-primary" id="restartBtn" style="margin-top: 2rem;">
                <i class="fas fa-redo"></i> Ulangi Quiz
            </button>
        </div>
    </main>
    
    <!-- Prayer Time Notification -->
    <div class="prayer-notification" id="prayerNotification">
        <i class="fas fa-mosque"></i>
        <span id="prayerMessage">Waktu sholat telah tiba. Aplikasi akan memutar adzan.</span>
    </div>
    
    <!-- Floating Action Buttons -->
    <div class="fab-container">
        <button class="fab fab-primary" id="musicToggle">
            <i class="fas fa-music"></i>
            <span class="fab-tooltip">Toggle Background Music</span>
        </button>
        <button class="fab fab-primary" id="soundToggle">
            <i class="fas fa-volume-up"></i>
            <span class="fab-tooltip">Toggle Sound Effects</span>
        </button>
        <button class="fab fab-info" id="pergunuLink">
            <i class="fas fa-link"></i>
            <span class="fab-tooltip">Go Link Pergunu</span>
        </button>
        <a href="https://wa.me/6285647709114" class="fab fab-success" target="_blank" id="callCenterBtn">
            <i class="fab fa-whatsapp"></i>
            <span class="fab-tooltip">Hubungi Developer</span>
        </a>
        <button class="fab fab-danger" id="adminBtn">
            <i class="fas fa-cog"></i>
            <span class="fab-tooltip">Admin Panel</span>
        </button>
    </div>
    
    <!-- Admin Overlay -->
    <div class="admin-overlay" id="adminOverlay"></div>
    
    <!-- Admin Login -->
    <div class="admin-panel" id="adminLogin">
        <div class="admin-header">
            <h2 class="admin-title"><i class="fas fa-lock"></i> Admin Login</h2>
            <button class="admin-close" id="adminClose">&times;</button>
        </div>
        
        <div class="form-group">
            <label for="adminPassword" class="form-label">Password Admin</label>
            <input type="password" id="adminPassword" class="form-control" placeholder="Masukkan password admin">
        </div>
        <button class="btn btn-primary" id="adminLoginBtn">
            <i class="fas fa-sign-in-alt"></i> Login
        </button>
    </div>
    
    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2 class="admin-title"><i class="fas fa-cog"></i> Panel Admin</h2>
            <button class="admin-close" id="adminPanelClose">&times;</button>
        </div>
        
        <div class="admin-content" id="adminContent" style="display: none;">
            <div class="form-group">
                <label for="adminCategoryFilter" class="form-label">Filter Kategori</label>
                <select id="adminCategoryFilter" class="form-control">
                    <option value="">Semua Kategori</option>
                    <option value="pelajar">Pelajar</option>
                    <option value="umum">Umum</option>
                </select>
            </div>
            
            <div class="question-list" id="questionList">
                <!-- Questions will be loaded here -->
            </div>
            
            <h3 class="admin-title"><i class="fas fa-plus-circle"></i> Tambah Soal Baru</h3>
            
            <!-- AI Prompt Section -->
            <div class="ai-prompt-section">
                <div class="ai-prompt-title">
                    <i class="fas fa-robot"></i> Generator Soal AI
                </div>
                <p style="margin-bottom: 0.75rem; font-size: 0.95rem;">Masukkan topik untuk menghasilkan soal secara otomatis:</p>
                <input type="text" id="aiPromptInput" class="ai-prompt-input" placeholder="Contoh: Soal matematika dasar tentang aljabar untuk pelajar SMP">
                <div class="ai-loading" id="aiLoading">
                    <i class="fas fa-spinner fa-spin"></i> Membuat soal, harap tunggu...
                </div>
                <button class="btn btn-success ai-generate-btn" id="generateQuestionBtn">
                    <i class="fas fa-magic"></i> Generate Soal dengan AI
                </button>
            </div>
            
            <form id="addQuestionForm">
                <div class="form-group">
                    <label for="newCategory" class="form-label">Kategori</label>
                    <select id="newCategory" class="form-control" required>
                        <option value="">Pilih Kategori</option>
                        <option value="pelajar">Pelajar</option>
                        <option value="umum">Umum</option>
                    </select>
                </div>
                
                <div class="form-group" id="newSubcategoryGroup" style="display: none;">
                    <label for="newSubcategory" class="form-label">Subkategori</label>
                    <select id="newSubcategory" class="form-control">
                        <option value="ipa">IPA</option>
                        <option value="ips">IPS</option>
                        <option value="matematika">Matematika</option>
                        <option value="agama">Agama</option>
                        <option value="ppkn">PPKN</option>
                        <option value="sejarah">Sejarah</option>
                        <option value="bahasa_indonesia">Bahasa Indonesia</option>
                        <option value="bahasa_inggris">Bahasa Inggris</option>
                    </select>
                </div>
                
                <div class="form-group" id="newUmumSubcategoryGroup" style="display: none;">
                    <label for="newUmumSubcategory" class="form-label">Jenis Ujian</label>
                    <select id="newUmumSubcategory" class="form-control">
                        <option value="logika">Ujian Logika</option>
                        <option value="sambung_lagu">Sambung Lagu</option>
                        <option value="peribahasa">Tebak Peribahasa</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="newLevel" class="form-label">Tingkat Kesulitan</label>
                    <select id="newLevel" class="form-control" required>
                        <option value="">Pilih Tingkat</option>
                        <option value="mudah">Mudah</option>
                        <option value="sedang">Sedang</option>
                        <option value="sulit">Sulit</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newQuestion" class="form-label">Pertanyaan</label>
                    <textarea id="newQuestion" class="form-control" rows="3" required placeholder="Masukkan pertanyaan"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Pilihan Jawaban</label>
                    <div class="options-grid">
                        <div class="option-input" style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <span class="option-prefix">A.</span>
                            <input type="text" id="optionA" class="form-control" placeholder="Pilihan A" required>
                        </div>
                        <div class="option-input" style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <span class="option-prefix">B.</span>
                            <input type="text" id="optionB" class="form-control" placeholder="Pilihan B" required>
                        </div>
                        <div class="option-input" style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <span class="option-prefix">C.</span>
                            <input type="text" id="optionC" class="form-control" placeholder="Pilihan C" required>
                        </div>
                        <div class="option-input" style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <span class="option-prefix">D.</span>
                            <input type="text" id="optionD" class="form-control" placeholder="Pilihan D" required>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="correctAnswer" class="form-label">Jawaban Benar</label>
                    <select id="correctAnswer" class="form-control" required>
                        <option value="">Pilih Jawaban Benar</option>
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newExplanation" class="form-label">Penjelasan Jawaban</label>
                    <textarea id="newExplanation" class="form-control" rows="3" required placeholder="Masukkan penjelasan jawaban"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelAddQuestion">
                        <i class="fas fa-times"></i> Batal
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Simpan Soal
                    </button>
                </div>
            </form>
            
            <div class="password-form" style="margin-top: 3rem;">
                <h3 class="admin-title"><i class="fas fa-key"></i> Ganti Password</h3>
                <form id="changePasswordForm">
                    <div class="form-group">
                        <label for="currentPassword" class="form-label">Password Lama</label>
                        <input type="password" id="currentPassword" class="form-control" required placeholder="Masukkan password lama">
                    </div>
                    <div class="form-group">
                        <label for="newPassword" class="form-label">Password Baru</label>
                        <input type="password" id="newPassword" class="form-control" required placeholder="Masukkan password baru (minimal 8 karakter)">
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword" class="form-label">Konfirmasi Password</label>
                        <input type="password" id="confirmPassword" class="form-control" required placeholder="Konfirmasi password baru">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-sync-alt"></i> Ganti Password
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Audio Elements -->
    <audio id="openingAudio" preload="auto">
        <source src="https://voca.ro/1a8eWbggFzfB" type="audio/mpeg">
    </audio>
    <audio id="welcomeAudio" preload="auto">
        <source src="https://voca.ro/1hlDz7uapOvO" type="audio/mpeg">
    </audio>
    <audio id="quizMusic" preload="auto" loop>
        <source src="https://voca.ro/1ay85sqaUP0k" type="audio/mpeg">
    </audio>
    <audio id="adhanAudio" preload="auto">
        <source src="https://voca.ro/16m9VCRDNVy1" type="audio/mpeg">
    </audio>
    <audio id="backgroundMusic" preload="auto" loop>
        <source src="https://voca.ro/1ffQ6LhkdPKe" type="audio/mpeg">
    </audio>
    <audio id="applauseSound" preload="auto">
        <source src="assets/audio/applause.mp3" type="audio/mpeg">
    </audio>
    <audio id="correctSound" preload="auto">
        <source src="assets/audio/correct.mp3" type="audio/mpeg">
    </audio>
    <audio id="wrongSound" preload="auto">
        <source src="assets/audio/wrong.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // Data Soal yang Diperluas
        let questions = {
            pelajar: {
                ipa: {
                    mudah: [
                        {
                            id: 1,
                            question: "Organ apa yang bertanggung jawab untuk memompa darah ke seluruh tubuh?",
                            options: ["Jantung", "Paru-paru", "Hati", "Ginjal"],
                            answer: 0,
                            explanation: "Jantung adalah organ yang bertugas memompa darah ke seluruh tubuh melalui sistem peredaran darah."
                        },
                        {
                            id: 2,
                            question: "Zat apa yang diperlukan tanaman untuk fotosintesis?",
                            options: ["Karbon dioksida", "Oksigen", "Nitrogen", "Hidrogen"],
                            answer: 0,
                            explanation: "Tanaman menggunakan karbon dioksida, air, dan cahaya matahari untuk menghasilkan glukosa dan oksigen melalui proses fotosintesis."
                        }
                    ],
                    sedang: [
                        {
                            id: 3,
                            question: "Apa nama proses perubahan wujud dari padat langsung ke gas?",
                            options: ["Sublimasi", "Kondensasi", "Evaporasi", "Deposisi"],
                            answer: 0,
                            explanation: "Sublimasi adalah proses perubahan wujud dari padat langsung ke gas tanpa melalui fase cair, contohnya pada kapur barus."
                        }
                    ],
                    sulit: [
                        {
                            id: 4,
                            question: "Berapa jumlah kromosom pada sel tubuh manusia normal?",
                            options: ["46", "23", "64", "32"],
                            answer: 0,
                            explanation: "Sel tubuh manusia normal (somatis) memiliki 46 kromosom atau 23 pasang kromosom."
                        }
                    ]
                },
                ips: {
                    mudah: [
                        {
                            id: 5,
                            question: "Apa ibukota provinsi Jawa Barat?",
                            options: ["Bandung", "Jakarta", "Surabaya", "Semarang"],
                            answer: 0,
                            explanation: "Ibukota provinsi Jawa Barat adalah Bandung."
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                matematika: {
                    mudah: [
                        {
                            id: 6,
                            question: "Berapakah hasil dari 7 × 8?",
                            options: ["56", "64", "42", "49"],
                            answer: 0,
                            explanation: "Hasil dari 7 dikali 8 adalah 56."
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                agama: {
                    mudah: [
                        {
                            id: 7,
                            question: "Berapa jumlah rakaat shalat Subuh?",
                            options: ["2", "3", "4", "1"],
                            answer: 0,
                            explanation: "Shalat Subuh terdiri dari 2 rakaat."
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                ppkn: {
                    mudah: [
                        {
                            id: 8,
                            question: "Siapa presiden pertama Indonesia?",
                            options: ["Soekarno", "Soeharto", "BJ Habibie", "Gus Dur"],
                            answer: 0,
                            explanation: "Presiden pertama Indonesia adalah Ir. Soekarno."
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                sejarah: {
                    mudah: [
                        {
                            id: 9,
                            question: "Kapan Indonesia merdeka?",
                            options: ["17 Agustus 1945", "27 Desember 1949", "1 Juni 1945", "28 Oktober 1928"],
                            answer: 0,
                            explanation: "Indonesia merdeka pada tanggal 17 Agustus 1945."
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                bahasa_indonesia: {
                    mudah: [
                        {
                            id: 10,
                            question: "Apa sinonim dari kata 'bahagia'?",
                            options: ["Senang", "Sedih", "Marah", "Kecewa"],
                            answer: 0,
                            explanation: "Sinonim dari bahagia adalah senang."
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                bahasa_inggris: {
                    mudah: [
                        {
                            id: 11,
                            question: "Apa bahasa Inggrisnya 'buku'?",
                            options: ["Book", "Pen", "Table", "Chair"],
                            answer: 0,
                            explanation: "Bahasa Inggris dari buku adalah book."
                        }
                    ],
                    sedang: [],
                    sulit: []
                }
            },
            umum: {
                logika: {
                    mudah: [
                        {
                            id: 12,
                            question: "Jika semua manusia adalah makhluk hidup, dan Budi adalah manusia, maka:",
                            options: ["Budi adalah makhluk hidup", "Budi bukan makhluk hidup", "Budi mungkin makhluk hidup", "Tidak bisa disimpulkan"],
                            answer: 0,
                            explanation: "Karena semua manusia adalah makhluk hidup dan Budi adalah manusia, maka Budi pasti makhluk hidup."
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                sambung_lagu: {
                    mudah: [
                        {
                            id: 13,
                            question: "Lanjutkan lirik: 'Tanah airku tidak kulupakan...'",
                            options: ["'Kan terkenang selama hidupku", "Selamanya akan kukenang", "Di hatiku selalu terpatri", "Takkan pernah kulupakan"],
                            answer: 0,
                            explanation: "Lirik lengkapnya: 'Tanah airku tidak kulupakan, 'kan terkenang selama hidupku'"
                        }
                    ],
                    sedang: [],
                    sulit: []
                },
                peribahasa: {
                    mudah: [
                        {
                            id: 14,
                            question: "Lanjutkan peribahasa: 'Air tenang...'",
                            options: ["menghanyutkan", "jernih selalu", "tak berombak", "dingin sekali"],
                            answer: 0,
                            explanation: "Peribahasa lengkapnya: 'Air tenang menghanyutkan' yang berarti orang yang kelihatannya pendiam bisa jadi berbahaya."
                        }
                    ],
                    sedang: [],
                    sulit: []
                }
            }
        };

        // Variabel Quiz
        let currentCategory = 'pelajar';
        let currentSubcategory = 'ipa';
        let currentLevel = 'mudah';
        let currentQuestionIndex = 0;
        let score = 0;
        let timer;
        let quizStartTime;
        let adminPassword = "65614222";
        let musicEnabled = true;
        let soundEffectsEnabled = true;
        let prayerTimeInterval;
        let quizMusicPlaying = false;

        // Inisialisasi
        document.addEventListener('DOMContentLoaded', function() {
            // Play opening audio
            playSound('openingAudio');
            
            // Show terms modal after opening animation
            setTimeout(() => {
                document.querySelector('.opening-screen').style.display = 'none';
                document.getElementById('termsModal').classList.add('active');
            }, 8000);
            
            initEventListeners();
            createFloatingStars();
            initParticles();
            checkPrayerTimes();
        });

        function initParticles() {
            particlesJS('particles-js', {
                "particles": {
                    "number": {
                        "value": 80,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                    },
                    "color": {
                        "value": "#3b82f6"
                    },
                    "shape": {
                        "type": "circle",
                        "stroke": {
                            "width": 0,
                            "color": "#000000"
                        },
                        "polygon": {
                            "nb_sides": 5
                        }
                    },
                    "opacity": {
                        "value": 0.3,
                        "random": false,
                        "anim": {
                            "enable": false,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                    },
                    "size": {
                        "value": 3,
                        "random": true,
                        "anim": {
                            "enable": false,
                            "speed": 40,
                            "size_min": 0.1,
                            "sync": false
                        }
                    },
                    "line_linked": {
                        "enable": true,
                        "distance": 150,
                        "color": "#3b82f6",
                        "opacity": 0.2,
                        "width": 1
                    },
                    "move": {
                        "enable": true,
                        "speed": 2,
                        "direction": "none",
                        "random": false,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false,
                        "attract": {
                            "enable": false,
                            "rotateX": 600,
                            "rotateY": 1200
                        }
                    }
                },
                "interactivity": {
                    "detect_on": "canvas",
                    "events": {
                        "onhover": {
                            "enable": true,
                            "mode": "grab"
                        },
                        "onclick": {
                            "enable": true,
                            "mode": "push"
                        },
                        "resize": true
                    },
                    "modes": {
                        "grab": {
                            "distance": 140,
                            "line_linked": {
                                "opacity": 1
                            }
                        },
                        "bubble": {
                            "distance": 400,
                            "size": 40,
                            "duration": 2,
                            "opacity": 8,
                            "speed": 3
                        },
                        "repulse": {
                            "distance": 200,
                            "duration": 0.4
                        },
                        "push": {
                            "particles_nb": 4
                        },
                        "remove": {
                            "particles_nb": 2
                        }
                    }
                },
                "retina_detect": true
            });
        }

        function createFloatingStars() {
            const starsContainer = document.getElementById('floatingStars');
            const starCount = 20;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                
                // Random size between 2px and 5px
                const size = Math.random() * 3 + 2;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                
                // Random position
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                
                // Random animation duration between 10s and 20s
                const duration = Math.random() * 10 + 10;
                star.style.animationDuration = `${duration}s`;
                
                // Random delay
                star.style.animationDelay = `${Math.random() * 5}s`;
                
                starsContainer.appendChild(star);
            }
        }

        function initEventListeners() {
            // Terms modal
            document.getElementById('acceptTerms').addEventListener('click', function() {
                if (document.getElementById('agreeTerms').checked) {
                    document.getElementById('termsModal').classList.remove('active');
                    playSound('welcomeAudio');
                } else {
                    alert('Anda harus menyetujui ketentuan penggunaan untuk melanjutkan');
                }
            });
            
            // Pilih kategori utama
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelector('.category-tab.active').classList.remove('active');
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    
                    // Tampilkan subkategori yang sesuai
                    if (currentCategory === 'pelajar') {
                        document.getElementById('pelajarSubcategories').style.display = 'block';
                        document.getElementById('umumSubcategories').style.display = 'none';
                        document.getElementById('profesiField').style.display = 'none';
                        document.querySelector('input[name="subcategory"][value="ipa"]').checked = true;
                        currentSubcategory = 'ipa';
                    } else {
                        document.getElementById('pelajarSubcategories').style.display = 'none';
                        document.getElementById('umumSubcategories').style.display = 'block';
                        document.getElementById('profesiField').style.display = 'block';
                        document.querySelector('input[name="subcategory"][value="logika"]').checked = true;
                        currentSubcategory = 'logika';
                    }
                });
            });
            
            // Pilih subkategori
            document.querySelectorAll('input[name="subcategory"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked) {
                        currentSubcategory = this.value;
                    }
                });
            });

            // Mulai quiz
            document.getElementById('startQuiz').addEventListener('click', function(e) {
                e.preventDefault();
                playSound('quizMusic');
                quizMusicPlaying = true;
                startQuiz(e);
            });

            // Admin toggle
            document.getElementById('adminBtn').addEventListener('click', toggleAdminPanel);
            document.getElementById('adminOverlay').addEventListener('click', closeAdminPanels);
            document.getElementById('adminClose').addEventListener('click', closeAdminPanels);
            document.getElementById('adminPanelClose').addEventListener('click', closeAdminPanels);

            // Admin login
            document.getElementById('adminLoginBtn').addEventListener('click', adminLogin);

            // Navigation buttons
            document.getElementById('nextBtn').addEventListener('click', nextQuestion);
            document.getElementById('resetBtn').addEventListener('click', resetQuiz);
            document.getElementById('restartBtn').addEventListener('click', resetQuiz);
            document.getElementById('homeBtn').addEventListener('click', function(e) {
                e.preventDefault();
                resetQuiz();
            });

            // Admin functions
            document.getElementById('adminCategoryFilter').addEventListener('change', filterQuestions);
            document.getElementById('addQuestionForm').addEventListener('submit', addQuestion);
            document.getElementById('cancelAddQuestion').addEventListener('click', function() {
                document.getElementById('addQuestionForm').reset();
            });
            document.getElementById('changePasswordForm').addEventListener('submit', changePassword);
            
            // Admin form category change
            document.getElementById('newCategory').addEventListener('change', function() {
                const category = this.value;
                document.getElementById('newSubcategoryGroup').style.display = category === 'pelajar' ? 'block' : 'none';
                document.getElementById('newUmumSubcategoryGroup').style.display = category === 'umum' ? 'block' : 'none';
            });
            
            // AI Question Generator
            document.getElementById('generateQuestionBtn').addEventListener('click', generateQuestionWithAI);
            
            // Share buttons
            document.getElementById('shareFacebook').addEventListener('click', shareFacebook);
            document.getElementById('shareTwitter').addEventListener('click', shareTwitter);
            document.getElementById('shareWhatsapp').addEventListener('click', shareWhatsapp);
            document.getElementById('printBtn').addEventListener('click', printResults);
            document.getElementById('screenshotBtn').addEventListener('click', takeScreenshot);
            
            // Music controls
            document.getElementById('musicToggle').addEventListener('click', toggleMusic);
            document.getElementById('soundToggle').addEventListener('click', toggleSoundEffects);
            
            // Pergunu link
            document.getElementById('pergunuLink').addEventListener('click', function() {
                window.open('https://is.gd/pergunusitubondo', '_blank');
            });
        }

        function toggleMusic() {
            musicEnabled = !musicEnabled;
            const musicBtn = document.getElementById('musicToggle');
            
            if (musicEnabled) {
                document.getElementById('backgroundMusic').play();
                musicBtn.innerHTML = '<i class="fas fa-music"></i>';
            } else {
                document.getElementById('backgroundMusic').pause();
                musicBtn.innerHTML = '<i class="fas fa-music-slash"></i>';
            }
        }

        function toggleSoundEffects() {
            soundEffectsEnabled = !soundEffectsEnabled;
            const soundBtn = document.getElementById('soundToggle');
            
            if (soundEffectsEnabled) {
                soundBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
            } else {
                soundBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
            }
        }

        function playSound(soundId) {
            if (soundId === 'quizMusic' && !quizMusicPlaying) return;
            if (soundId === 'backgroundMusic' && !musicEnabled) return;
            if (soundId !== 'backgroundMusic' && soundId !== 'quizMusic' && !soundEffectsEnabled) return;
            
            const sound = document.getElementById(soundId);
            sound.currentTime = 0; // Rewind to start
            const promise = sound.play();
            
            if (promise !== undefined) {
                promise.catch(error => {
                    console.log("Autoplay prevented:", error);
                });
            }
        }

        function stopSound(soundId) {
            const sound = document.getElementById(soundId);
            sound.pause();
            sound.currentTime = 0;
        }

        function checkPrayerTimes() {
            // This is a simplified version - in a real app you would use a prayer times API
            prayerTimeInterval = setInterval(function() {
                const now = new Date();
                const hours = now.getHours();
                const minutes = now.getMinutes();
                
                // Example prayer times (adjust according to actual prayer times)
                const prayerTimes = [
                    { name: "Subuh", hour: 4, minute: 30 },
                    { name: "Dzuhur", hour: 12, minute: 0 },
                    { name: "Ashar", hour: 15, minute: 30 },
                    { name: "Maghrib", hour: 18, minute: 0 },
                    { name: "Isya", hour: 19, minute: 30 }
                ];
                
                // Check if current time matches any prayer time (within 5 minutes)
                for (const prayer of prayerTimes) {
                    if (hours === prayer.hour && minutes >= prayer.minute && minutes <= prayer.minute + 5) {
                        showPrayerNotification(prayer.name);
                        return;
                    }
                }
            }, 60000); // Check every minute
        }

        function showPrayerNotification(prayerName) {
            if (quizMusicPlaying) {
                stopSound('quizMusic');
                quizMusicPlaying = false;
            }
            
            document.getElementById('prayerMessage').textContent = `Waktu sholat ${prayerName} telah tiba. Aplikasi akan memutar adzan.`;
            document.getElementById('prayerNotification').style.display = 'flex';
            
            playSound('adhanAudio');
            
            setTimeout(function() {
                document.getElementById('prayerNotification').style.display = 'none';
                
                // Resume quiz music after adhan finishes (approx 3 minutes)
                setTimeout(function() {
                    if (document.getElementById('quizContainer').style.display === 'block') {
                        playSound('quizMusic');
                        quizMusicPlaying = true;
                    }
                }, 180000);
            }, 10000); // Hide notification after 10 seconds
        }

        function startQuiz(e) {
            e.preventDefault();
            
            // Get participant data
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const profesi = currentCategory === 'umum' ? document.getElementById('profesi').value : '';
            currentLevel = document.getElementById('level').value;
            
            if (!name || !phone) {
                alert('Silakan isi nama lengkap dan nomor HP terlebih dahulu');
                return;
            }
            
            // Check if there are questions for selected category/subcategory/level
            const availableQuestions = questions[currentCategory][currentSubcategory][currentLevel];
            if (!availableQuestions || availableQuestions.length === 0) {
                alert('Belum ada soal untuk kategori, subkategori, dan level yang dipilih!');
                return;
            }
            
            // Update quiz info
            document.getElementById('categoryDisplay').textContent = currentCategory === 'pelajar' ? 'Pelajar' : 'Umum';
            
            // Set subcategory display text
            let subcategoryText = '';
            if (currentCategory === 'pelajar') {
                const subcategoryMap = {
                    'ipa': 'IPA',
                    'ips': 'IPS',
                    'matematika': 'Matematika',
                    'agama': 'Agama',
                    'ppkn': 'PPKN',
                    'sejarah': 'Sejarah',
                    'bahasa_indonesia': 'Bahasa Indonesia',
                    'bahasa_inggris': 'Bahasa Inggris'
                };
                subcategoryText = subcategoryMap[currentSubcategory];
            } else {
                const subcategoryMap = {
                    'logika': 'Logika',
                    'sambung_lagu': 'Sambung Lagu',
                    'peribahasa': 'Peribahasa'
                };
                subcategoryText = subcategoryMap[currentSubcategory];
            }
            document.getElementById('subcategoryDisplay').textContent = subcategoryText;
            
            document.getElementById('levelDisplay').textContent = 
                currentLevel.charAt(0).toUpperCase() + currentLevel.slice(1);
            
            // Hide form and show quiz
            document.getElementById('participantForm').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('resultsContainer').style.display = 'none';
            
            // Reset variables
            currentQuestionIndex = 0;
            score = 0;
            quizStartTime = new Date();
            
            // Start timer
            startTimer();
            
            // Load first question
            loadQuestion();
        }

        /* ... (keep all other existing quiz functions the same) ... */

        function resetQuiz() {
            clearInterval(timer);
            
            // Stop quiz music
            stopSound('quizMusic');
            quizMusicPlaying = false;
            
            // Reset UI
            document.getElementById('participantForm').style.display = 'block';
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'none';
            
            // Reset form
            document.getElementById('participantForm').reset();
            document.querySelector('.category-tab[data-category="pelajar"]').classList.add('active');
            document.querySelectorAll('.category-tab[data-category="umum"]').forEach(tab => tab.classList.remove('active'));
            currentCategory = 'pelajar';
            
            // Show pelajar subcategories by default
            document.getElementById('pelajarSubcategories').style.display = 'block';
            document.getElementById('umumSubcategories').style.display = 'none';
            document.getElementById('profesiField').style.display = 'none';
            document.querySelector('input[name="subcategory"][value="ipa"]').checked = true;
            currentSubcategory = 'ipa';
            
            // Remove confetti
            document.querySelectorAll('.confetti').forEach(el => el.remove());
        }

        function createConfetti() {
            const colors = ['#2563eb', '#1d4ed8', '#dc2626', '#16a34a', '#d97706'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = Math.random() * 10 + 5 + 'px';
                confetti.style.height = Math.random() * 10 + 5 + 'px';
                confetti.style.animationDuration = Math.random() * 3 + 2 + 's';
                confetti.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(confetti);
                
                // Remove after animation
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        /* ... (keep all other existing functions the same) ... */
    </script>
</body>
</html>
